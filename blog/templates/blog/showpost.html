{% extends 'blog/base.html' %}

{% load static %}
{% load bootstrap %}
{% load blog_extras %}


{% block title %}{{ post.title }}{% endblock %}

{% block header %}
    <link rel="stylesheet" href="{% static 'blog/lib/css/bootstrap.min.css' %}">  
    <link rel="stylesheet" href="{% static 'blog/newpost.css' %}">
    {{ post.media }}
{% endblock %}

{% block body %}

<div class="mx-md-4">
    <br>
    <div class="d-flex">
        <div>
            <a href="{% url 'main_profile' post.user.username %}" style=" color: #363636;">
                {% if post.user.image  %}
                <img src="/media/{{ post.user.image }}" width=80 height=80 
                style="border-radius: 40px; position: relative; top: 50%; transform: translateY(-50%);">
                {% else %}
                <img src="/media/user_imgs/DefaultUserImage.png" width=80 height=80
                style="border-radius: 40px; position: relative; top: 50%; transform: translateY(-50%);">
                {% endif %}
            </a>
        </div>
        <div class="me-3">
            <div class="mb-2 mt-2 pt-1">
                <a href="{% url 'main_profile' post.user.username %}" style=" color: #363636; text-decoration: none;">
                    {{ post.user.username }}
                </a>
            </div>
            <div class="mb-2" style="color: #858585; ">
                {{ post.post_send_time|timesince|persian_int }} پیش
            </div>
        </div>
    </div>

    <br>
    <h1>{{ post.title }}</h1>

    <br>
    <div>
        {% if post.image  %}
            <a href="{% url 'showpost' post.user.username post.pk %}">
                <img src="/media/{{ post.image }}" width=100% height=100%>
            </a>
        {% endif %}
    </div>
    <br><br>

    <div style="font-size: 1.1rem;">
        {{ post.text|safe }}
    </div>

    {% for tag in tags %}
        <input class="pb-1 pt-2" name='tag' style='text-align: center; color: black; background-color:#a5a5a5; margin:2px 3px; display:inline; border:none;' value='{{tag.name}}' disabled>
    {% endfor %}
    
    <br><br>


    <div class="d-flex justify-content-between">
        <div class="d-flex">
            <div class="d-flex">
                <button class="btn shadow-none">
                    <i class="far fa-comment fa-lg"></i>
                </button>
                <p class="d-none">{{ post|post_comments }}</p>
                <p class="mt-2">{{ post|post_comments|persian_int }}</p>
            </div>

            <div class="d-flex pb-1">
                {% if can_accept %}
                    {% if post.accept_by_admin %}
                        <input id='accept_post' class="btn" type='button' value='عدم تایید'>
                    {% else %}
                        <input id='accept_post' class="btn" type='button' value='تایید'>
                    {% endif %}
                {% endif %}
            </div>
        </div>
        
        <div class="d-flex">
            <div class="d-flex">
                {% if owner %}        
                    <button class="btn shadow-none" >
                        <a href="{% url 'editpost' post.user.username post.pk%}" style="color: #212529;">
                            <i class="far fa-edit fa-lg"></i>
                        </a>
                    </button>
                {% endif %}        
            </div>

            <div class="d-flex">
                <button id="like" class="btn shadow-none">
                    <i class="far fa-thumbs-up fa-lg"></i>
                </button>
                <p class="d-none">{{ post|post_likes }}</p>
                <p class="mt-2">{{ post|post_likes|persian_int }}</p>
            </div>

            <div class="d-flex">
                <button id="dislike" class="btn shadow-none">
                    <i class="far fa-thumbs-down fa-lg"></i>
                </button>
                <p class="d-none">{{ post|post_dislikes }}</p>
                <p class="mt-2">{{ post|post_dislikes|persian_int }}</p>
            </div>
        </div>
        
    </div>
    <br><br>

</div>

<div class="mx-md-4">
    <p>نظرات</p>

    {% for comment in allcomments %}

        {% if comment.accept_by_admin %}
            {% include "blog/commenttag.html" with comment=comment %}
        {% endif %}

        {% if not comment.accept_by_admin and can_accept %}
            {% include "blog/commenttag.html" with comment=comment %}
        {% endif %}

    {% endfor %}
        
    {% csrf_token %}
    <br>

</div>

{% endblock %}


{% block script %}
    <script src="{% static 'blog/lib/js/jquery-3.4.1.min.js' %}"></script>
    <script src="{% static 'blog/lib/js/bootstrap.min.js' %}"></script>
    <!--<script src="{% static 'blog/tinymce.min.js' %}"></script>-->
    <script src="{% static 'blog/showpost.js' %}"></script>
{% endblock %}
